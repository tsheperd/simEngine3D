clear;close all;clc;
g = -9.81;
m = 4.1888;
k = 5;
x0 = -4;
v0 = 0;
c = 1;

ttt = linspace(0,10,100);

%% DAMPED
x_anal = g.*k.^(-1).*m+exp(1).^((-1/2).*c.*m.^(-1).*ttt).*(k.^(-1).*((-1).* ...
  g.*m+k.*x0).*cos((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m).^(1/2).*ttt)+( ...
  (-1).*c.^2+4.*k.*m).^(-1/2).*(2.*m.*v0+c.*k.^(-1).*((-1).*g.*m+k.* ...
  x0)).*sin((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m).^(1/2).*ttt));

x_dot_anal = exp(1).^((-1/2).*c.*m.^(-1).*ttt).*((1/2).*m.^(-1).*(2.*m.*v0+c.* ...
  k.^(-1).*((-1).*g.*m+k.*x0)).*cos((1/2).*m.^(-1).*((-1).*c.^2+4.* ...
  k.*m).^(1/2).*ttt)+(-1/2).*k.^(-1).*m.^(-1).*((-1).*c.^2+4.*k.*m).^( ...
  1/2).*((-1).*g.*m+k.*x0).*sin((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m) ...
  .^(1/2).*ttt))+(-1/2).*c.*exp(1).^((-1/2).*c.*m.^(-1).*ttt).*m.^(-1).* ...
  (k.^(-1).*((-1).*g.*m+k.*x0).*cos((1/2).*m.^(-1).*((-1).*c.^2+4.* ...
  k.*m).^(1/2).*ttt)+((-1).*c.^2+4.*k.*m).^(-1/2).*(2.*m.*v0+c.*k.^( ...
  -1).*((-1).*g.*m+k.*x0)).*sin((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m) ...
  .^(1/2).*ttt));

x_ddot_anal = (-1).*c.*exp(1).^((-1/2).*c.*m.^(-1).*ttt).*m.^(-1).*((1/2).*m.^(-1) ...
  .*(2.*m.*v0+c.*k.^(-1).*((-1).*g.*m+k.*x0)).*cos((1/2).*m.^(-1).*( ...
  (-1).*c.^2+4.*k.*m).^(1/2).*ttt)+(-1/2).*k.^(-1).*m.^(-1).*((-1).* ...
  c.^2+4.*k.*m).^(1/2).*((-1).*g.*m+k.*x0).*sin((1/2).*m.^(-1).*(( ...
  -1).*c.^2+4.*k.*m).^(1/2).*ttt))+(1/4).*c.^2.*exp(1).^((-1/2).*c.* ...
  m.^(-1).*ttt).*m.^(-2).*(k.^(-1).*((-1).*g.*m+k.*x0).*cos((1/2).* ...
  m.^(-1).*((-1).*c.^2+4.*k.*m).^(1/2).*ttt)+((-1).*c.^2+4.*k.*m).^( ...
  -1/2).*(2.*m.*v0+c.*k.^(-1).*((-1).*g.*m+k.*x0)).*sin((1/2).*m.^( ...
  -1).*((-1).*c.^2+4.*k.*m).^(1/2).*ttt))+exp(1).^((-1/2).*c.*m.^(-1) ...
  .*ttt).*((-1/4).*k.^(-1).*m.^(-2).*((-1).*c.^2+4.*k.*m).*((-1).*g.* ...
  m+k.*x0).*cos((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m).^(1/2).*ttt)+( ...
  -1/4).*m.^(-2).*((-1).*c.^2+4.*k.*m).^(1/2).*(2.*m.*v0+c.*k.^(-1) ...
  .*((-1).*g.*m+k.*x0)).*sin((1/2).*m.^(-1).*((-1).*c.^2+4.*k.*m).^( ...
  1/2).*ttt));

figure;
plot(ttt,x_anal);

figure;
plot(ttt,x_dot_anal)

figure;
plot(ttt,x_ddot_anal)


%% UNDAMPED
x_anal = g.*k.^(-1).*m+k.^(-1).*((-1).*g.*m+k.*x0).*cos(k.^(1/2).*m.^(-1/2) ...
  .*ttt)+k.^(-1/2).*m.^(1/2).*v0.*sin(k.^(1/2).*m.^(-1/2).*ttt);

x_dot_anal = v0.*cos(k.^(1/2).*m.^(-1/2).*ttt)+(-1).*k.^(-1/2).*m.^(-1/2).*((-1) ...
  .*g.*m+k.*x0).*sin(k.^(1/2).*m.^(-1/2).*ttt);

x_ddot_anal = (-1).*m.^(-1).*((-1).*g.*m+k.*x0).*cos(k.^(1/2).*m.^(-1/2).*ttt)+( ...
  -1).*k.^(1/2).*m.^(-1/2).*v0.*sin(k.^(1/2).*m.^(-1/2).*ttt);

figure;
plot(ttt,x_anal);

figure;
plot(ttt,x_dot_anal)

figure;
plot(ttt,x_ddot_anal)